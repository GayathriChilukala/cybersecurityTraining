% Incidence Matrix for IEEE 39-Bus system

A = zeros(39,39);

% Assign values for lines
A(1,2)=1; A(1,39)=1;
A(2,3)=1; A(2,25)=1;
A(3,4)=1; A(3,18)=1;
A(4,5)=1; A(4,14)=1;
A(5,6)=1; A(5,8)=1;
A(6,7)=1; A(6,11)=1;
A(7,8)=1;
A(8,9)=1;
A(9,39)=1;
A(10,11)=1; A(10,13)=1;
A(13,14)=1;
A(14,15)=1;
A(15,16)=1;
A(16,17)=1;A(16,19)=1;A(16,21)=1;A(16,24)=1;
A(17,18)=1;A(17,27)=1;
A(21,22)=1;
A(22,23)=1;
A(23,24)=1;
A(25,26)=1;
A(26,27)=1;A(26,28)=1;A(26,29)=1;
A(28,29)=1;

% Assign values for transformers
A(2,30)=1;
A(31,6)=1;
A(10,32)=1;
A(12,11)=1;
A(12,13)=1;
A(19,20)=1;
A(19,33)=1;
A(20,34)=1;
A(22,35)=1;
A(23,36)=1;
A(25,37)=1;
A(29,38)=1;

A = A+A'+eye(39);

x = zeros(1,39);
y = x*A;
index = find(y==0);

while (index),
    x(index(1)) = 1;
    y = x*A;
    index = find(y==0);
end




